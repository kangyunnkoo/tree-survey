<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>수목위치도(One)</title>
  <style>
    #map { width: 100%; height: 100vh; }
  </style>
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=4010951d8779c420a474f095fd26c0a6"></script>
</head>
<body>
  <div id="map"></div>
  <script>
    // URL 파라미터 파싱
    const params = new URLSearchParams(window.location.search);
    const lat = parseFloat(params.get("lat")) || 37.5665; // 기본: 서울시청
    const lng = parseFloat(params.get("lng")) || 126.9780;
    const treeNo = parseFloat(params.get("treeNo")) || 1;
    
    // 지도 생성 (중심좌표를 파라미터로 반영)
    const mapContainer = document.getElementById("map");
    const mapOption = {
      center: new kakao.maps.LatLng(lat, lng),
      level: 5
    };
    const map = new kakao.maps.Map(mapContainer, mapOption);

    // Canvas로 번호 마커 이미지 생성 함수
    function createNumberMarker(num) {
      const size = 18;
      const canvas = document.createElement("canvas");
      canvas.width = size;
      canvas.height = size;
      const ctx = canvas.getContext("2d");

      // 원형 배경
      ctx.fillStyle = "#1976d2";
      ctx.beginPath();
      ctx.arc(size/2, size/2, size/2, 0, Math.PI * 2);
      ctx.fill();

      // 숫자
      ctx.fillStyle = "#fff";
      ctx.font = "bold 10px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(num, size/2, size/2);

      return new kakao.maps.MarkerImage(
        canvas.toDataURL(),
        new kakao.maps.Size(size, size)
      );
    }

    const marker = new kakao.maps.Marker({
      position: new kakao.maps.LatLng(lat, lng),
      image: createNumberMarker(treeNo),
      map: map
    });
  </script>
</body>
</html>
