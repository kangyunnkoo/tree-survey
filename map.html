<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>수목 위치도</title>
  <style>
    #map {width:100%; height:100vh;}
  </style>
  <script type="text/javascript" 
    src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=여기에_본인_카카오_API키">
  </script>
</head>
<body>
<div id="map"></div>
<script>
  // 1) URL에서 details 파라미터 읽기
  const urlParams = new URLSearchParams(window.location.search);
  const detailsRaw = urlParams.get('details');

  let details = [];
  try {
    details = JSON.parse(detailsRaw);
  } catch(e) {
    console.error("details JSON parse error", e);
  }

  if (details.length > 0) {
    // 지도 초기화 (첫번째 좌표 기준)
    const map = new kakao.maps.Map(document.getElementById('map'), {
      center: new kakao.maps.LatLng(details[0].lat, details[0].lng),
      level: 5
    });

    const bounds = new kakao.maps.LatLngBounds();

    details.forEach(item => {
      const pos = new kakao.maps.LatLng(item.lat, item.lng);
      const marker = new kakao.maps.Marker({ position: pos, map });

      const overlay = new kakao.maps.CustomOverlay({
        position: pos,
        content: `<div style="background:#fff;border:1px solid #333;padding:2px 4px;font-size:12px;">${item.label}</div>`,
        yAnchor: 1.5
      });
      overlay.setMap(map);

      bounds.extend(pos);
    });

    map.setBounds(bounds);
  } else {
    document.body.innerHTML = "<p>표시할 데이터가 없습니다.</p>";
  }
</script>
</body>
</html>
